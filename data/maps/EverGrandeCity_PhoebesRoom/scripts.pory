mapscripts EverGrandeCity_PhoebesRoom_MapScripts {
	MAP_SCRIPT_ON_FRAME_TABLE[
		VAR_ELITE_4_STATE, 1 : EverGrandeCity_PhoebesRoom_EventScript_WalkInCloseDoor
	]
	MAP_SCRIPT_ON_LOAD : EverGrandeCity_PhoebesRoom_OnLoad
    MAP_SCRIPT_ON_WARP_INTO_MAP_TABLE[
        VAR_TEMP_1, 0 : PokemonLeague_EliteFour_EventScript_PlayerTurnNorth
    ]
}

script EverGrandeCity_PhoebesRoom_EventScript_WalkInCloseDoor {
	lockall
	call(PokemonLeague_EliteFour_EventScript_WalkInCloseDoor)
	setvar(VAR_ELITE_4_STATE, 2)
	releaseall
	end
}

script EverGrandeCity_PhoebesRoom_OnLoad {
	call_if_set(FLAG_DEFEATED_ELITE_4_LUCY, PokemonLeague_EliteFour_EventScript_ResetAdvanceToNextRoom)
	call_if_eq(VAR_ELITE_4_STATE, 2, PokemonLeague_EliteFour_EventScript_CloseDoor)
	end
}

script EverGrandeCity_PhoebesRoom_EventScript_Lucy {
	lock
	faceplayer
	goto_if_set(FLAG_DEFEATED_ELITE_4_LUCY, EverGrandeCity_PhoebesRoom_EventScript_PostBattleSpeech)
	playbgm(MUS_ENCOUNTER_ELITE_FOUR, FALSE)
	setflag(FLAG_USE_NEXT_LEVEL_CAP)
	msgbox(EverGrandeCity_PhoebesRoom_Text_IntroSpeech, MSGBOX_DEFAULT)
	trainerbattle_no_intro(TRAINER_LUCY_1, EverGrandeCity_PhoebesRoom_Text_Defeat)
	
	clearflag(FLAG_USE_NEXT_LEVEL_CAP)
	setflag(FLAG_DEFEATED_ELITE_4_LUCY)
	call(PokemonLeague_EliteFour_SetAdvanceToNextRoomMetatiles)
	EverGrandeCity_PhoebesRoom_EventScript_PostBattleSpeech:
	msgbox(EverGrandeCity_PhoebesRoom_Text_PostBattleSpeech, MSGBOX_DEFAULT)
	release
	end
}

text EverGrandeCity_PhoebesRoom_Text_IntroSpeech {
	"I am Lucy.\n"
	"I am the law here…\p"
	"You already know it, but to advance,\n"
	"you must defeat me…\p"
	"…I'm not one for idle chatter.\n"
	"Hurry… I hope you didn't use up all of\l"
	"your luck getting here…"
}
text EverGrandeCity_PhoebesRoom_Text_Defeat {
	"Urk…"
}
text EverGrandeCity_PhoebesRoom_Text_PostBattleSpeech {
	"Head on to the next room…\p"
	"That's all there is…\n"
	"Disappear already…"
}