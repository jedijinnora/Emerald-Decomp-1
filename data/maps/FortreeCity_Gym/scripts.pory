script FortreeCity_Gym_EventScript_GymGuide {
	lock
	faceplayer
	if(flag(FLAG_SYS_GAME_CLEAR)) {
		msgbox(format("Good to see you again, Champion {PLAYER}! I knew you had it in you!"), MSGBOX_NPC)
		release
		end
	}
	if(flag(FLAG_BADGE06_GET)) {
		msgbox("Wonderful showing!\nA battle straight from the heart!", MSGBOX_NPC)
		release
		end
	}
	msgbox(FortreeCity_Gym_Text_GymGuideAdvice, MSGBOX_NPC)
	release
	end
}

text FortreeCity_Gym_Text_GymGuideAdvice {
	"Ho, challenger! You've braved the\n"
	"jungle of Hoenn to reach Fortree.\p"
	"Now you face the master of nature's\n"
	"wisdom, Gym Leader Spenser!\p"
	"You'll have to push past Spenser's\n"
	"students to reach the sage himself!"
}

script FortreeCity_Gym_EventScript_Spenser {
	lock
	faceplayer
	goto_if_set(FLAG_SYS_GAME_CLEAR, SpenserRematch)
	goto_if_set(FLAG_DEFEATED_FORTREE_GYM, SpenserEnd)
	//check number of badges and return appropriate battle
	switch(var(VAR_NUM_BADGES)) {
		case 0:
			//badge 1 team
			trainerbattle_single(TRAINER_WINONA_1, FortreeCity_Gym_Text_SpenserIntro, FortreeCity_Gym_Text_SpenserDefeat, FortreeCity_Gym_EventScript_SpenserDefeated, NO_MUSIC)
		case 1:
			//badge 2 team
		case 2:
		case 3:
			//badge 34 team
		case 4:
		case 5:
		case 6:
			//badge 567 team
		case 7:
			//badge 8 team
			trainerbattle_single(TRAINER_WINONA_1, FortreeCity_Gym_Text_SpenserIntro, FortreeCity_Gym_Text_SpenserDefeat, FortreeCity_Gym_EventScript_SpenserDefeated, NO_MUSIC)
		default:
			goto_if_unset(FLAG_TEMP_1, SpenserRematch)
	}
	goto(SpenserEnd)

	SpenserRematch:
	goto_if_set(FLAG_TEMP_1, SpenserEnd)
	msgbox("… … …\nSo, are you ready?", MSGBOX_YESNO)
	goto_if_eq(VAR_RESULT, NO, SpenserEnd)
	setflag(FLAG_TEMP_1)
	cleartrainerflag(TRAINER_WINONA_1)
	trainerbattle_single(TRAINER_WINONA_1, FortreeCity_Gym_Text_SpenserPreRematch, FortreeCity_Gym_Text_SpenserRematchDefeat)

	SpenserEnd:
	msgbox(FortreeCity_Gym_Text_SpenserPostBattle)
	release
	end
}

script FortreeCity_Gym_EventScript_SpenserDefeated {
	message(FortreeCity_Gym_Text_ReceivedFeatherBadge)
	waitmessage
	call(Common_EventScript_PlayGymBadgeFanfare)
	setflag(FLAG_DEFEATED_FORTREE_GYM)
	setflag(FLAG_BADGE06_GET)
	setflag(FLAG_CHALLENGE_FERRY_TICKET)
	addvar(VAR_NUM_BADGES, 1)
	setvar(VAR_0x8008, 6)
	call(Common_EventScript_SetGymTrainers)
	call_if_unset(FLAG_CHALLENGE_HM_NONE, Gym_EventScript_GetHM)
	msgbox(FortreeCity_Gym_Text_SpenserPostBattle)
	return
}

text FortreeCity_Gym_Text_SpenserIntro {
	"Spenser: My physical being is with\n"
	"Pokémon always!\p"
	"My heart beats as one with\n"
	"Pokémon always!\p"
	"Young one of a Trainer!\n"
	"Do you believe in your Pokémon?\p"
	"Can you believe them through\n"
	"and through?\p"
	"If your bonds of trust are frail,\n"
	"you will never beat my brethren!"
}

text FortreeCity_Gym_Text_SpenserDefeat {
	"Spenser: Gwahahah!\p"
	"Hah, you never fell for my bluster!\n"
	"Sorry for trying that stunt!\p"
	"Here!"
}

text FortreeCity_Gym_Text_SpenserPostBattle {
	"Spenser: Your Pokémon's eyes are \n"
	"truly clear and unclouded.\p"
	"I will eagerly await the next\n"
	"opportunity to see you."
}

text FortreeCity_Gym_Text_SpenserPreRematch {
	"Spenser: Gwahahah!\n"
	"You must have developed a truly\l"
	"formidable bond with your Pokémon.\p"
	"So be it!\p"
	"This time, I won't bluster or hold back.\n"
	"This time, there's no fooling around.\p"
	"Ready now?\n"
	"Prepare to lose!"
}

text FortreeCity_Gym_Text_SpenserRematchDefeat {
	"Spenser: Well, that was some display!\n"
	"Even fully unleashed, my brethren\l"
	"could not overpower you.\p"
	"Your team spirit is truly admirable!\p"
}

raw `
FortreeCity_Gym_MapScripts::
	map_script MAP_SCRIPT_ON_TRANSITION, FortreeCity_Gym_OnTransition
	map_script MAP_SCRIPT_ON_WARP_INTO_MAP_TABLE, FortreeCity_Gym_OnWarp
	.byte 0

FortreeCity_Gym_OnTransition:
	special RotatingGate_InitPuzzle
	end

FortreeCity_Gym_OnWarp:
	map_script_2 VAR_TEMP_0, VAR_TEMP_0, FortreeCity_Gym_EventScript_InitRotatingGates
	.2byte 0

@ NOTE: This rotating gate puzzle makes use of VAR_TEMP_0 - VAR_TEMP_3
FortreeCity_Gym_EventScript_InitRotatingGates::
	special RotatingGate_InitPuzzleAndGraphics
	end

FortreeCity_Gym_EventScript_Jared::
	trainerbattle_single TRAINER_JARED, FortreeCity_Gym_Text_JaredIntro, FortreeCity_Gym_Text_JaredDefeat
	msgbox FortreeCity_Gym_Text_JaredPostBattle, MSGBOX_AUTOCLOSE
	end

FortreeCity_Gym_EventScript_Edwardo::
	trainerbattle_single TRAINER_EDWARDO, FortreeCity_Gym_Text_EdwardoIntro, FortreeCity_Gym_Text_EdwardoDefeat
	msgbox FortreeCity_Gym_Text_EdwardoPostBattle, MSGBOX_AUTOCLOSE
	end

FortreeCity_Gym_EventScript_Flint::
	trainerbattle_single TRAINER_FLINT, FortreeCity_Gym_Text_FlintIntro, FortreeCity_Gym_Text_FlintDefeat
	msgbox FortreeCity_Gym_Text_FlintPostBattle, MSGBOX_AUTOCLOSE
	end

FortreeCity_Gym_EventScript_Ashley::
	trainerbattle_single TRAINER_ASHLEY, FortreeCity_Gym_Text_AshleyIntro, FortreeCity_Gym_Text_AshleyDefeat
	msgbox FortreeCity_Gym_Text_AshleyPostBattle, MSGBOX_AUTOCLOSE
	end

FortreeCity_Gym_EventScript_Humberto::
	trainerbattle_single TRAINER_HUMBERTO, FortreeCity_Gym_Text_HumbertoIntro, FortreeCity_Gym_Text_HumbertoDefeat
	msgbox FortreeCity_Gym_Text_HumbertoPostBattle, MSGBOX_AUTOCLOSE
	end

FortreeCity_Gym_EventScript_Darius::
	trainerbattle_single TRAINER_DARIUS, FortreeCity_Gym_Text_DariusIntro, FortreeCity_Gym_Text_DariusDefeat
	msgbox FortreeCity_Gym_Text_DariusPostBattle, MSGBOX_AUTOCLOSE
	end

FortreeCity_Gym_EventScript_LeftGymStatue::
	lockall
	goto_if_set FLAG_BADGE06_GET, FortreeCity_Gym_EventScript_GymStatueCertified
	goto FortreeCity_Gym_EventScript_GymStatue
	end

FortreeCity_Gym_EventScript_RightGymStatue::
	lockall
	goto_if_set FLAG_BADGE06_GET, FortreeCity_Gym_EventScript_GymStatueCertified
	goto FortreeCity_Gym_EventScript_GymStatue
	end

FortreeCity_Gym_EventScript_GymStatueCertified::
	msgbox FortreeCity_Gym_Text_GymStatueCertified, MSGBOX_DEFAULT
	releaseall
	end

FortreeCity_Gym_EventScript_GymStatue::
	msgbox FortreeCity_Gym_Text_GymStatue, MSGBOX_DEFAULT
	releaseall
	end

FortreeCity_Gym_Text_JaredIntro:
	.string "Behold the elegant battle style of\n"
	.string "jungle Pokémon!$"

FortreeCity_Gym_Text_JaredDefeat:
	.string "You…\n"
	.string "You're strong…$"

FortreeCity_Gym_Text_JaredPostBattle:
	.string "A Trainer has to be smart to keep\n"
	.string "up with unexpected turns of events.\p"
	.string "Do you have the smarts to get to\n"
	.string "our Leader?$"

FortreeCity_Gym_Text_EdwardoIntro:
	.string "The lovers of Grass Pokémon aspire\n"
	.string "to join this Gym.\p"
	.string "As a member of the Fortree Gym,\n"
	.string "I'm not allowed to lose!$"

FortreeCity_Gym_Text_EdwardoDefeat:
	.string "It was too much of a load for me\n"
	.string "to bear…$"

FortreeCity_Gym_Text_EdwardoPostBattle:
	.string "The world is huge, and there are\n"
	.string "countless tough Trainers.\p"
	.string "I'm going to keep training and make\n"
	.string "myself even stronger.$"

FortreeCity_Gym_Text_FlintIntro:
	.string "There's no need for Spenser, our Gym\n"
	.string "Leader, to deal with you!\p"
	.string "I'm plenty good enough for you!$"

FortreeCity_Gym_Text_FlintDefeat:
	.string "Spenser, I…\n"
	.string "I lost!$"

FortreeCity_Gym_Text_FlintPostBattle:
	.string "Spenser is wise and strong.\n"
	.string "He's the ultimate Leader!$"

FortreeCity_Gym_Text_AshleyIntro:
	.string "Spenser taught me personally!\n"
	.string "You can't beat me easily!$"

FortreeCity_Gym_Text_AshleyDefeat:
	.string "I was beaten…$"

FortreeCity_Gym_Text_AshleyPostBattle:
	.string "Thanks to Spenser, the people of\n"
	.string "Fortree can live without fear.$"

FortreeCity_Gym_Text_HumbertoIntro:
	.string "When Spenser takes to battle, his face\n"
	.string "shines with beautiful determination…\p"
	.string "I'm not letting you witness that\n"
	.string "lovely sight!$"

FortreeCity_Gym_Text_HumbertoDefeat:
	.string "Urk!\n"
	.string "I couldn't stop you.$"

FortreeCity_Gym_Text_HumbertoPostBattle:
	.string "You'd better watch it!\n"
	.string "Don't get distracted staring at Spenser\l"
	.string "or you'll go crashing down in a heap!$"

FortreeCity_Gym_Text_DariusIntro:
	.string "You'd better know that there are all\n"
	.string "sorts of Grass-type Pokémon.\p"
	.string "You do know that, right?$"

FortreeCity_Gym_Text_DariusDefeat:
	.string "You seem to know your stuff!$"

FortreeCity_Gym_Text_DariusPostBattle:
	.string "Sure, you beat me all right.\n"
	.string "But you'd better watch it! Our Leader\l"
	.string "Spenser's Pokémon are all business.$"

FortreeCity_Gym_Text_WinonaIntro:
	.string "I am Winona. I am the Leader of\n"
	.string "the Fortree Pokémon Gym.\p"
	.string "I have become one with Bird Pokémon\n"
	.string "and have soared the skies…\p"
	.string "However grueling the battle, we have\n"
	.string "triumphed with grace…\p"
	.string "Witness the elegant choreography\n"
	.string "of Bird Pokémon and I!$"

FortreeCity_Gym_Text_WinonaDefeat:
	.string "Never before have I seen a Trainer\n"
	.string "command Pokémon with more grace\l"
	.string "than I…\p"
	.string "In recognition of your prowess,\n"
	.string "I present to you this Gym Badge.$"

FortreeCity_Gym_Text_ReceivedFeatherBadge:
	.string "{PLAYER} received the Feather Badge\n"
	.string "from Spenser.$"

FortreeCity_Gym_Text_ExplainFeatherBadgeTakeThis:
	.string "With the Feather Badge, all Pokémon up\n"
	.string "to Lv 70, even those received through\l"
	.string "trades, will obey your every command.\p"
	.string "You will also be able to use\n"
	.string "the HM move Fly outside of battle.\p"
	.string "And this…\n"
	.string "This is a gift from me.$"

FortreeCity_Gym_Text_ExplainAerialAce:
	.string "TM40 contains Aerial Ace.\p"
	.string "Its speed…\n"
	.string "No Pokémon should be able to avoid it.\p"
	.string "… … … … … …$"

FortreeCity_Gym_Text_RegisteredWinona:
	.string "Registered Gym Leader Winona\n"
	.string "in the Pokénav.$"

FortreeCity_Gym_Text_WinonaPostBattle:
	.string "Though I fell to you, I will remain\n"
	.string "devoted to Bird Pokémon.$"

FortreeCity_Gym_Text_GymStatue:
	.string "Fortree City Pokémon Gym$"

FortreeCity_Gym_Text_GymStatueCertified:
	.string "Fortree City Pokémon Gym\p"
	.string "Spenser's certified Trainers:\n"
	.string "{PLAYER}$"

FortreeCity_Gym_Text_WinonaPreRematch:
	.string "Winona: We humans can never escape\n"
	.string "gravity's pull on the ground.\p"
	.string "But by striving for excellence,\n"
	.string "we have the power to soar!\p"
	.string "You have scaled the pinnacle as\n"
	.string "the reigning Champion.\p"
	.string "Please, allow me to see your power\n"
	.string "at full flight!$"

FortreeCity_Gym_Text_WinonaRematchDefeat:
	.string "I failed to reach your height again…$"

FortreeCity_Gym_Text_WinonaPostRematch:
	.string "Winona: Even though I have lost,\n"
	.string "the wings of my heart remain unbroken.\p"
	.string "I can rise and soar again and\n"
	.string "yet again.\p"
	.string "I am convinced of it!$"

FortreeCity_Gym_Text_WinonaRematchNeedTwoMons:
	.string "Winona: We humans can never escape\n"
	.string "gravity's pull on the ground.\p"
	.string "But by striving for excellence,\n"
	.string "we have the power to soar!\p"
	.string "You have scaled the pinnacle as\n"
	.string "the reigning Champion.\p"
	.string "Please, allow me to see your power\n"
	.string "at full flight!\p"
	.string "Oh, no… Do you have but one\n"
	.string "Pokémon with you?\p"
	.string "Please return with two Pokémon\n"
	.string "at the very least.$"
`
